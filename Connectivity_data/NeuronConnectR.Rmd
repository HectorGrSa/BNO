---
title: "NeuronConnect_R"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown
```{r}
library("igraph")
library("plyr")
```



#Preparacio dades C.Elegans


```{r}
# documentacio matriu https://www.wormatlas.org/neuronalwiring.html#NeuronalconnectivityII
# documentacio igraph https://kateto.net/netscix2016.html

archiu <- read.csv("NeuronConnect.csv",sep = ";")

unique(archiu$Type)


ab <- nrow(archiu)
for (i in 1:ab) {
  if(archiu[i,3]=="R" | archiu[i,3]=="Rp"){
    archiu[i,] <- archiu[i, c(2,1,3,4)]
  }
  if(archiu[i,3]=="EJ"){
  
    archiu <- rbind.fill(archiu,archiu[i,])
  }
}

g <- graph_from_edgelist(as.matrix(archiu[,c(1,2)]), directed = TRUE)

E(g)$weight <- archiu$Nbr
E(g)$name <- archiu$Type


gs <- simplify( g , remove.multiple = T, remove.loops = F, edge.attr.comb=c(weight="sum", type="ignore") )
```

```{r}
l <- layout_with_fr(gs)
plot(gs, rescale=F, layout=l*0.4)
```

```{r}
l <- layout_with_fr(gs)

V(gs)$color <- colrs[V(gs)$media.type]

V(gs)$size <- V(gs)$audience.size*0.7

V(gs)$label.color <- "black"

V(gs)$label <- NA

E(gs)$width <- E(gs)$weight/6

E(gs)$arrow.size <- .2

E(gs)$width <- 1+E(gs)$weight/12

plot(gs,rescale=F,layout=l*0.8)
```

```{r}
barplot(triad_census(gs), log="y")
```

```{r}
#Color nodes along the diameter:

diam <- get_diameter(gs, directed=T)

as.vector(diam)

vcol <- rep("gray40", vcount(gs))

vcol[diam] <- "gold"

ecol <- rep("gray80", ecount(gs))

ecol[E(gs, path=diam)] <- "orange" 


plot(gs, rescale=F,vertex.color=vcol, edge.color=ecol, edge.arrow.mode=0)
```

```{r}
#encontrar el camino más corto entre nodos específicos.

news.path <- shortest_paths(gs, 

                            from = V(gs)[as.list(names)=="ADFL"], 

                             to  = V(gs)[as.list(names)=="SMBVR"],

                             output = "both") # both path nodes and edges



# Generate edge color variable to plot the path:

ecol <- rep("gray80", ecount(gs))

ecol[unlist(news.path$epath)] <- "orange"

# Generate edge width variable to plot the path:

ew <- rep(2, ecount(gs))

ew[unlist(news.path$epath)] <- 4

# Generate node color variable to plot the path:

vcol <- rep("gray40", vcount(gs))

vcol[unlist(news.path$vpath)] <- "gold"



plot(gs,rescale=F, vertex.color=vcol, edge.color=ecol, 

     edge.width=ew, edge.arrow.mode=0)
```

```{r}
inc.edges <- incident(gs,  V(gs)[media=="ADFL"], mode="all")



# Set colors to plot the selected edges.

ecol <- rep("gray80", ecount(gs))

ecol[inc.edges] <- "orange"

vcol <- rep("grey40", vcount(gs))

vcol[V(gs)$media=="ADFL"] <- "gold"

plot(gs,rescale=F, vertex.color=vcol, edge.color=ecol)
```

```{r}
cocitation(gs)
```

```{r}
#comunidades
ceb <- cluster_edge_betweenness(gs) 

plot(ceb, gs) 
```

```{r}
cfg <- cluster_fast_greedy(as.undirected(gs))

plot(cfg, as.undirected(gs))

l <- layout_with_fr(gs)

plot(cfg, resacle=F, as.undirected(gs), layout=l*1.0)

```




##-------------------------------------------------------------------------------------------------------------------
```{r}
#Degree distribution


plot(gs, vertex.size=6, vertex.label=NA, layout=layout_in_circle)  


deg <- degree(gs, mode="all")

deg.distF <- degree_distribution(gs, cumulative=F, mode="all")

deg.distT <- degree_distribution(gs, cumulative=T, mode="all")



#Triad census
tirad_gs = triad_census(gs)

#Hubs
hs_gs <- hub_score(gs, weights=NA)$vector

#Authorities
as_gs <- authority_score(gs, weights=NA)$vector


#Small-Worldness ratio: 
SM_Ratio_gs = transitivity(gs)/mean_distance(gs)

#modularity
library(leiden)
adj_mtx_gs  <- igraph::as_adjacency_matrix(gs)
wtc_gs <- leiden(adj_mtx_gs)
modularity_gs <- modularity(gs, wtc_gs)

celegans_data <- list()
celegans_data[["deg_distF_celegans"]] <- deg.distF
celegans_data[["deg_distT_celegans"]] <- deg.distT
celegans_data[["triad_census_celegans"]] <- tirad_gs
celegans_data[["hub_score_celegans"]] <- hs_gs
celegans_data[["modularity_celegans"]] <- modularity_gs
celegans_data[["authority_score_celegans"]] <- as_gs 
celegans_data[["SW_ratio_celegans"]] <- SM_Ratio_gs 

save(celegans_data, file="celegans_data.RData")

load("celegans_data.RData")

```


# ---GENERAR 3 XARXES ALEATORIES PER COMPARAR---

## Erdos-Renyi random graph model

```{r}
set.seed(2706)

er_xarxa1 <- sample_gnm(n=283, m=3109, directed = TRUE) 

deg_xarxa1 <- degree(er_xarxa1, mode="all")

deg.dist_xarxaF1 <- degree_distribution(er_xarxa1, cumulative=F, mode="all")

deg.dist_xarxaT1 <- degree_distribution(er_xarxa1, cumulative=T, mode="all")


tirad_er_xarxa1 = triad_census(er_xarxa1)


#Hubs
hs_er_xarxa1 <- hub_score(er_xarxa1, weights=NA)$vector


#Authorities
as_er_xarxa1 <- authority_score(er_xarxa1, weights=NA)$vector


#Small-Worldness ratio: 
SM_Ratio_er_xarxa1 = transitivity(er_xarxa1)/mean_distance(er_xarxa1)


#modularity
library(leiden)
adj_mtx_er_xarxa1  <- igraph::as_adjacency_matrix(er_xarxa1)
wtc_er_xarxa1 <- leiden(adj_mtx_er_xarxa1)
modularity_er_xarxa1 <- modularity(er_xarxa1, wtc_er_xarxa1)


celegansER_data <- list()
celegansER_data[["deg_distF_celegansER"]] <- deg.dist_xarxaF1
celegansER_data[["deg_distT_celegansER"]] <- deg.dist_xarxaT1
celegansER_data[["triad_census_celegansER"]] <- tirad_er_xarxa1
celegansER_data[["hub_score_celegansER"]] <- hs_er_xarxa1
celegansER_data[["modularity_celegansER"]] <- modularity_er_xarxa1
celegansER_data[["authority_score_celegansER"]] <- as_er_xarxa1 
celegansER_data[["SW_ratio_celegansER"]] <- SM_Ratio_er_xarxa1 

save(celegansER_data, file="celegansER_data.RData")

load("celegansER_data.RData")


```





## Watts-Strogatz small-world model

```{r}
sw_xarxa2 <- sample_smallworld(dim=1, size=283, nei=11, p=0.1)
plot(sw_xarxa2, vertex.size=6, vertex.label=NA, layout=layout_in_circle)


deg_xarxa2 <- degree(sw_xarxa2, mode="all")


deg.dist_xarxaF2 <- degree_distribution(sw_xarxa2, cumulative=F, mode="all")

deg.dist_xarxaT2 <- degree_distribution(sw_xarxa2, cumulative=T, mode="all")


tirad_sw_xarxa2 = triad_census(sw_xarxa2)

#Hubs
hs_sw_xarxa2 <- hub_score(sw_xarxa2, weights=NA)$vector

#Authorities
as_sw_xarxa2 <- authority_score(sw_xarxa2, weights=NA)$vector

#Small-Worldness ratio: 
SM_Ratio_sw_xarxa2 = transitivity(sw_xarxa2)/mean_distance(sw_xarxa2)

#modularity
library(leiden)
adj_mtx_sw_xarxa2  <- igraph::as_adjacency_matrix(sw_xarxa2)
wtc_sw_xarxa2 <- leiden(adj_mtx_sw_xarxa2)
modularity_sw_xarxa2 <- modularity(sw_xarxa2, wtc_sw_xarxa2)


celegansSW_data <- list()
celegansSW_data[["deg_distF_celegansSW"]] <- deg.dist_xarxaF2
celegansSW_data[["deg_distT_celegansSW"]] <- deg.dist_xarxaT2
celegansSW_data[["triad_census_celegansSW"]] <- tirad_sw_xarxa2
celegansSW_data[["hub_score_celegansSW"]] <- hs_sw_xarxa2
celegansSW_data[["modularity_celegansSW"]] <- modularity_sw_xarxa2
celegansSW_data[["authority_score_celegansSW"]] <- as_sw_xarxa2 
celegansSW_data[["SW_ratio_celegansSW"]] <- SM_Ratio_sw_xarxa2 

save(celegansSW_data, file="celegansSW_data.RData")

load("celegansSW_data.RData")
```


## Barabasi-Albert preferential attachment model for scale-free graphs

```{r}
ba_xarxa3 <-  sample_pa(n=283, power=1, m=11,  directed=T)

deg_xarxa3 <- degree(ba_xarxa3, mode="all")

deg.dist_xarxaF3 <- degree_distribution(ba_xarxa3, cumulative=F, mode="all")

deg.dist_xarxaT3 <- degree_distribution(ba_xarxa3, cumulative=T, mode="all")

tirad_census_ba_xarxa3 = triad_census(ba_xarxa3)

#Hubs
hs_ba_xarxa3 <- hub_score(ba_xarxa3, weights=NA)$vector

#Authorities
as_ba_xarxa3 <- authority_score(ba_xarxa3, weights=NA)$vector

#Small-Worldness ratio: 
SM_Ratio_ba_xarxa3 = transitivity(ba_xarxa3)/mean_distance(ba_xarxa3)

#modularity
library(leiden)
adj_mtx_ba_xarxa3  <- igraph::as_adjacency_matrix(ba_xarxa3)
wtc_ba_xarxa3 <- leiden(adj_mtx_ba_xarxa3)
modularity_ba_xarxa3 <- modularity(ba_xarxa3, wtc_ba_xarxa3)



celegansBA_data <- list()
celegansBA_data[["deg_distF_celegansBA"]] <- deg.dist_xarxaF3
celegansBA_data[["deg_distT_celegansBA"]] <- deg.dist_xarxaT3
celegansBA_data[["triad_census_celegansBA"]] <- tirad_census_ba_xarxa3
celegansBA_data[["hub_score_celegansBA"]] <- hs_ba_xarxa3
celegansBA_data[["modularity_celegansBA"]] <- modularity_ba_xarxa3
celegansBA_data[["authority_score_celegansBA"]] <- as_ba_xarxa3 
celegansBA_data[["SW_ratio_celegansBA"]] <- SM_Ratio_ba_xarxa3 

save(celegansBA_data, file="celegansBA_data.RData")

load("celegansBA_data.RData")
```





```{r}
df_plot1 <- data.frame(deg=rep(0:max(deg),4),
                       freq=c(1-deg.distT,
                              c(1-deg.dist_xarxaT1,rep(1,max(deg)-max(deg_xarxa1))),
                              c(1-deg.dist_xarxaT2,rep(1,max(deg)-max(deg_xarxa2))),
                              c(1-deg.dist_xarxaT3[0:(max(deg)+1)])
                              ),
                       type=c(rep("c.elegans",max(deg)+1),
                              rep("Erdös-Renyi",max(deg)+1),
                              rep("Small-World",max(deg)+1),
                              rep("Barabasi-Alberts",max(deg)+1)
                              )
                       )

library(ggplot2)
ggplot(df_plot1, aes(x=deg,y=freq,color=type)) + geom_point()
```

```{r}
df_plot2 <- data.frame(deg=rep(0:max(deg),4),
                       freq=c(deg.distF,
                              c(deg.dist_xarxaF1,rep(0,max(deg)-max(deg_xarxa1))),
                              c(deg.dist_xarxaF2,rep(0,max(deg)-max(deg_xarxa2))),
                              c(deg.dist_xarxaF3[0:(max(deg)+1)])
                              ),
                       type=c(rep("c.elegans",max(deg)+1),
                              rep("Erdös-Renyi",max(deg)+1),
                              rep("Small-World",max(deg)+1),
                              rep("Barabasi-Alberts",max(deg)+1)
                              )
                       )

library(ggplot2)
ggplot(df_plot2, aes(x=deg,y=freq,color=type)) + 
  geom_point() + 
  scale_y_log10() + 
  scale_x_log10(limits=c(5,100)) +
  geom_smooth(aes(fill=type)) +
  theme_classic()

```










#----------------------------FLY EM -------------------------------------------------------------------------










```{r}
archiuFly <- read.csv("v1.2_exported-traced-adjacencies-v1.2.csv",sep = ",",header = F,skip = 1)

```

```{r}
# archiuFly[,1] <- as.numeric(as.factor(archiuFly[,1]))
# archiuFly[,2] <- as.numeric(as.factor(archiuFly[,2]))
# archiuFly[,3] <- as.numeric(as.factor(archiuFly[,3]))
# gFly <- graph_from_edgelist(as.matrix(archiuFly[,c(1,2)]), directed = TRUE)
# 
# gFlyS <- simplify( gFly , remove.multiple = T, remove.loops = F, edge.attr.comb=c(weight="sum", type="ignore") )
# 
# save(gFlyS, file="gFlyS.RData")

load("gFlyS.RData")

```

```{r}
#l <- layout_with_fr(gFlyS)
#plot(gFlyS, rescale=F, layout=l*0.4)
```

```{r}
#Degree distribution

#plot(gFlyS, vertex.size=6, vertex.label=NA, layout=layout_in_circle)

degFly <- degree(gFlyS, mode="all")

deg.degFlyF <- degree_distribution(gFlyS, cumulative=F, mode="all")

deg.degFlyT <- degree_distribution(gFlyS, cumulative=T, mode="all")

tirad_census_gFlyS = triad_census(gFlyS)


#Hubs
hs_gFlyS <- hub_score(gFlyS, weights=NA)$vector


#Authorities
as_gFlyS<- authority_score(gFlyS, weights=NA)$vector


#Small-Worldness ratio: 
SM_Ratio_gFlyS = transitivity(gFlyS)/mean_distance(gFlyS)

#modularity
library(leiden)
adj_mtx_gFlyS  <- igraph::as_adjacency_matrix(gFlyS)
wtc_gFlyS <- leiden(adj_mtx_gFlyS)
modularity_gFlyS <- modularity(gFlyS, wtc_gFlyS)

FlyEM_data <- list()
FlyEM_data[["deg_distF_FlyEM"]] <- deg.degFlyF
FlyEM_data[["deg_distT_FlyEM"]] <- deg.degFlyT
FlyEM_data[["triad_census_FlyEM"]] <- tirad_census_gFlyS
FlyEM_data[["hub_score_FlyEM"]] <- hs_gFlyS
FlyEM_data[["modularity_FlyEM"]] <- modularity_gFlyS
FlyEM_data[["authority_score_FlyEM"]] <- as_gFlyS 
FlyEM_data[["SW_ratio_FlyEM"]] <- SM_Ratio_gFlyS 

save(FlyEM_data, file="FlyEM_data.RData")

load("FlyEM_data.RData")




```




```{r}
set.seed(2706)

er_Fly <- sample_gnm(n=length(unique(archiuFly[,1])), m=length(E(gFlyS))) #n= NUmero de nodes (unique(archiuFly[,1])) m=numero de links (length(E(gFlyS)))
#plot(er_Fly, vertex.size=6, vertex.label=NA, layout=layout_in_circle)  


deg_erFly <- degree(er_Fly, mode="all")

deg.dist_erFlyF <- degree_distribution(er_Fly, cumulative=F, mode="all")

deg.dist_erFlyT <- degree_distribution(er_Fly, cumulative=T, mode="all")

tirad_census_er_Fly = triad_census(er_Fly)


#Hubs
hs_er_Fly <- hub_score(er_Fly, weights=NA)$vector


#Authorities
as_er_Fly <- authority_score(er_Fly, weights=NA)$vector


#Small-Worldness ratio: 
SM_Ratio_er_Fly = transitivity(er_Fly)/mean_distance(er_Fly)

#modularity
library(leiden)
adj_mtx_er_Fly  <- igraph::as_adjacency_matrix(er_Fly)
wtc_er_Fly <- leiden(adj_mtx_er_Fly)
modularity_er_Fly <- modularity(er_Fly, wtc_er_Fly)

FlyEM_ER_data <- list()
FlyEM_ER_data[["deg_distF_FlyEM_ER"]] <- deg.dist_erFlyF
FlyEM_ER_data[["deg_distT_FlyEM_ER"]] <- deg.dist_erFlyT
FlyEM_ER_data[["triad_census_FlyEM_ER"]] <- tirad_census_er_Fly
FlyEM_ER_data[["hub_score_FlyEM_ER"]] <- hs_er_Fly
FlyEM_ER_data[["modularity_FlyEM_ER"]] <- modularity_er_Fly
FlyEM_ER_data[["authority_score_FlyEM_ER"]] <- as_er_Fly 
FlyEM_ER_data[["SW_ratio_FlyEM_ER"]] <- SM_Ratio_er_Fly 

save(FlyEM_ER_data, file="FlyEM_ER_data.RData")

load("FlyEM_ER_data.RData")
```



```{r}
sw_Fly <- sample_smallworld(dim=1, size=length(unique(archiuFly[,1])), nei=11, p=0.1)
#plot(sw_Fly, vertex.size=6, vertex.label=NA, layout=layout_in_circle)


deg_swFly <- degree(sw_Fly, mode="all")

deg.dist_swFlyF <- degree_distribution(sw_Fly, cumulative=F, mode="all")

deg.dist_swFlyT <- degree_distribution(sw_Fly, cumulative=T, mode="all")

tirad_census_sw_Fly = triad_census(sw_Fly)

#Hubs
hs_sw_Fly <- hub_score(sw_Fly, weights=NA)$vector

#Authorities
as_sw_Fly <- authority_score(sw_Fly, weights=NA)$vector

#Small-Worldness ratio: 
SM_Ratio_sw_Fly = transitivity(sw_Fly)/mean_distance(sw_Fly)

#modularity
library(leiden)
adj_mtx_sw_Fly  <- igraph::as_adjacency_matrix(sw_Fly)
wtc_sw_Fly <- leiden(adj_mtx_sw_Fly)
modularity_sw_Fly <- modularity(sw_Fly, wtc_sw_Fly)

FlyEM_SW_data <- list()
FlyEM_SW_data[["deg_distF_FlyEM_SW"]] <- deg.dist_swFlyF
FlyEM_SW_data[["deg_distT_FlyEM_SW"]] <- deg.dist_swFlyT
FlyEM_SW_data[["triad_census_FlyEM_SW"]] <- tirad_census_sw_Fly
FlyEM_SW_data[["hub_score_FlyEM_SW"]] <- hs_sw_Fly
FlyEM_SW_data[["modularity_FlyEM_SW"]] <- modularity_sw_Fly
FlyEM_SW_data[["authority_score_FlyEM_SW"]] <- as_sw_Fly 
FlyEM_SW_data[["SW_ratio_FlyEM_SW"]] <- SM_Ratio_sw_Fly 

save(FlyEM_SW_data, file="FlyEM_SW_data.RData")

load("FlyEM_SW_data.RData")
```


```{r}
ba_fly <-  sample_pa(n=length(unique(archiuFly[,1])), power=1, m=11,  directed=T)
#plot(ba_fly, vertex.size=6, vertex.label=NA, layout=layout_in_circle)


deg_baFly <- degree(ba_fly, mode="all")

deg.dist_baFlyF <- degree_distribution(ba_fly, cumulative=F, mode="all")

deg.dist_baFyT <- degree_distribution(ba_fly, cumulative=T, mode="all")

tirad_census_ba_fly = triad_census(ba_fly)

#Hubs
hs_ba_fly <- hub_score(ba_fly, weights=NA)$vector


#Authorities
as_baFly <- authority_score(ba_fly, weights=NA)$vector


#Small-Worldness ratio: 
SM_Ratio_ba_fly= transitivity(ba_fly)/mean_distance(ba_fly)

#modularity
library(leiden)
adj_mtx_ba_fly  <- igraph::as_adjacency_matrix(ba_fly)
wtc_ba_fly <- leiden(adj_mtx_ba_fly)
modularity_ba_fly <- modularity(ba_fly, wtc_ba_fly)

FlyEM_BA_data <- list()
FlyEM_BA_data[["deg_distF_FlyEM_BA"]] <- deg.dist_baFlyF
FlyEM_BA_data[["deg_distT_FlyEM_BA"]] <- deg.dist_baFyT
FlyEM_BA_data[["triad_census_FlyEM_BA"]] <- tirad_census_ba_fly
FlyEM_BA_data[["hub_score_FlyEM_BA"]] <- hs_ba_fly
FlyEM_BA_data[["modularity_FlyEM_BA"]] <- modularity_ba_fly
FlyEM_BA_data[["authority_score_FlyEM_BA"]] <- as_baFly 
FlyEM_BA_data[["SW_ratio_FlyEM_BA"]] <- SM_Ratio_ba_fly 

save(FlyEM_BA_data, file="FlyEM_BA_data.RData")

load("FlyEM_BA_data.RData")
```


##----------------------------------------FLY OPTIC--------------------------------------------------------------##



```{r}
archiuFlyOPtic <- read.table("FlyCircuit.csv",sep = ";",row.names=1,header=T)

```

```{r}
gFlyOptic <- graph_from_adjacency_matrix(as.matrix(archiuFlyOPtic))
gFlyOpticS <- simplify(gFlyOptic , remove.multiple = T, remove.loops = F, edge.attr.comb=c(weight="sum", type="ignore") )
```

```{r}
l <- layout_with_fr(gFlyOpticS)
plot(gFlyOpticS, rescale=F, layout=l*0.4)
```


```{r}
#Degree distribution

degFlyOptic <- degree(gFlyOpticS, mode="all")

deg.degFlyOF <- degree_distribution(gFlyOpticS, cumulative=F, mode="all")


deg.degFlyOT <- degree_distribution(gFlyOpticS, cumulative=T, mode="all")


tirad_census_FlyOptic = barplot(triad_census(gFlyOpticS), log="y")


#Hubs
hs_FlyOptic <- hub_score(gFlyOpticS, weights=NA)$vector



#Authorities
as_FlyOptic <- authority_score(gFlyOpticS, weights=NA)$vector

#Small-Worldness ratio: 
SM_Ratio_FlyOptic= transitivity(gFlyOpticS)/mean_distance(gFlyOpticS)

#modularity
library(leiden)
adj_mtx_FlyOptic  <- igraph::as_adjacency_matrix(gFlyOpticS)
wtc_FlyOptic <- leiden(adj_mtx_FlyOptic)
modularity_FlyOptic <- modularity(gFlyOpticS, wtc_FlyOptic)

FlyOP_data <- list()
FlyOP_data[["deg_distF_FlyOP"]] <- deg.degFlyOF
FlyOP_data[["deg_distT_FlyOP"]] <- deg.degFlyOT
FlyOP_data[["triad_census_FlyOP"]] <- tirad_census_FlyOptic
FlyOP_data[["hub_score_FlyOP"]] <- hs_FlyOptic
FlyOP_data[["modularity_FlyOP"]] <- modularity_FlyOptic
FlyOP_data[["authority_score_FlyOP"]] <- as_FlyOptic 
FlyOP_data[["SW_ratio_FlyOP"]] <- SM_Ratio_FlyOptic 

save(FlyOP_data, file="FlyOP_data.RData")

load("FlyOP_data.RData")
```




```{r}
set.seed(2706)

er_FlyO <- sample_gnm(n=length(unique(archiuFlyOPtic[,1])), m=length(E(gFlyOpticS)),directed=T) 


deg_erFlyO <- degree(er_FlyO, mode="all")



deg.dist_erFlyOF <- degree_distribution(er_FlyO, cumulative=F, mode="all")


deg.dist_erFlyOT <- degree_distribution(er_FlyO, cumulative=T, mode="all")


tirad_census_er_FlyO = barplot(triad_census(er_FlyO), log="y")

#Hubs
hs_er_FlyO <- hub_score(er_FlyO, weights=NA)$vector

#Authorities
as_er_FlyO <- authority_score(er_FlyO, weights=NA)$vector

#Small-Worldness ratio: 
SM_Ratio_er_FlyO= transitivity(er_FlyO)/mean_distance(er_FlyO)

#modularity
library(leiden)
adj_mtx_er_FlyO  <- igraph::as_adjacency_matrix(er_FlyO)
wtc_er_FlyO <- leiden(adj_mtx_er_FlyO)
modularity_er_FlyO <- modularity(er_FlyO, wtc_er_FlyO)

FlyOP_ER_data <- list()
FlyOP_ER_data[["deg_distF_FlyOP_ER"]] <- deg.dist_erFlyOF
FlyOP_ER_data[["deg_distT_FlyOP_ER"]] <- deg.dist_erFlyOT
FlyOP_ER_data[["triad_census_FlyOP_ER"]] <- tirad_census_er_FlyO
FlyOP_ER_data[["hub_score_FlyOP_ER"]] <- hs_er_FlyO
FlyOP_ER_data[["modularity_FlyOP_ER"]] <- modularity_er_FlyO
FlyOP_ER_data[["authority_score_FlyOP_ER"]] <- as_er_FlyO 
FlyOP_ER_data[["SW_ratio_FlyOP_ER"]] <- SM_Ratio_er_FlyO 

save(FlyOP_ER_data, file="FlyOP_ER_data.RData")

load("FlyOP_ER_data.RData")

```





```{r}
sw_FlyO <- sample_smallworld(dim=1, size=length(unique(archiuFlyOPtic[,1])), nei=11, p=0.1)
#plot(sw_Fly, vertex.size=6, vertex.label=NA, layout=layout_in_circle)


deg_swFlyO <- degree(sw_FlyO, mode="all")


deg.dist_swFlyFO <- degree_distribution(sw_FlyO, cumulative=F, mode="all")


deg.dist_swFlyTO <- degree_distribution(sw_FlyO, cumulative=T, mode="all")


tirad_census_sw_FlyO = barplot(triad_census(sw_FlyO), log="y")

#Hubs
hs_sw_FlyO <- hub_score(sw_FlyO, weights=NA)$vector

#Authorities
as_sw_FlyO <- authority_score(sw_FlyO, weights=NA)$vector

#Small-Worldness ratio: 
SM_Ratio_sw_FlyO= transitivity(sw_FlyO)/mean_distance(sw_FlyO)

#modularity
library(leiden)
adj_mtx_sw_FlyO  <- igraph::as_adjacency_matrix(sw_FlyO)
wtc_sw_FlyO <- leiden(adj_mtx_sw_FlyO)
modularity_sw_FlyO <- modularity(sw_FlyO, wtc_sw_FlyO)

FlyOP_SW_data <- list()
FlyOP_SW_data[["deg_distF_FlyOP_SW"]] <- deg.dist_swFlyFO
FlyOP_SW_data[["deg_distT_FlyOP_SW"]] <- deg.dist_swFlyTO
FlyOP_SW_data[["triad_census_FlyOP_SW"]] <- tirad_census_sw_FlyO
FlyOP_SW_data[["hub_score_FlyOP_SW"]] <- hs_sw_FlyO
FlyOP_SW_data[["modularity_FlyOP_SW"]] <- modularity_sw_FlyO
FlyOP_SW_data[["authority_score_FlyOP_SW"]] <- as_sw_FlyO 
FlyOP_SW_data[["SW_ratio_FlyOP_SW"]] <- SM_Ratio_sw_FlyO 

save(FlyOP_SW_data, file="FlyOP_SW_data.RData")

load("FlyOP_SW_data.RData")

```

```{r}
ba_flyO <-  sample_pa(n=length(unique(archiuFlyOPtic[,1])), power=1, m=11,  directed=T)
#plot(ba_fly, vertex.size=6, vertex.label=NA, layout=layout_in_circle)


deg_baFlyO <- degree(ba_flyO, mode="all")


deg.dist_baFlyFO <- degree_distribution(ba_flyO, cumulative=F, mode="all")


deg.dist_baFyTO <- degree_distribution(ba_flyO, cumulative=T, mode="all")


tirad_census_ba_flyO = barplot(triad_census(ba_flyO), log="y")

#Hubs
hs_ba_flyO <- hub_score(ba_flyO, weights=NA)$vector

#Authorities
as_ba_flyO <- authority_score(ba_flyO, weights=NA)$vector

#Small-Worldness ratio: 
SM_Ratio_ba_flyO= transitivity(ba_flyO)/mean_distance(ba_flyO)

#modularity
library(leiden)
adj_mtx_ba_flyO  <- igraph::as_adjacency_matrix(ba_flyO)
wtc_ba_flyO <- leiden(adj_mtx_ba_flyO)
modularity_ba_flyO <- modularity(ba_flyO, wtc_ba_flyO)

FlyOP_BA_data <- list()
FlyOP_BA_data[["deg_distF_FlyOP_BA"]] <- deg.dist_baFlyFO
FlyOP_BA_data[["deg_distT_FlyOP_BA"]] <- deg.dist_baFyTO
FlyOP_BA_data[["triad_census_FlyOP_BA"]] <- tirad_census_ba_flyO
FlyOP_BA_data[["hub_score_FlyOP_BA"]] <- hs_ba_flyO
FlyOP_BA_data[["modularity_FlyOP_BA"]] <- modularity_ba_flyO
FlyOP_BA_data[["authority_score_FlyOP_BA"]] <- as_ba_flyO 
FlyOP_BA_data[["SW_ratio_FlyOP_BA"]] <- SM_Ratio_ba_flyO 

save(FlyOP_BA_data, file="FlyOP_BA_data.RData")

load("FlyOP_BA_data.RData")

```


