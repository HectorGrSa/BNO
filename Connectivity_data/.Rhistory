library("igraph")
library("plyr")
archiu <- read.csv("NeuronConnect.csv",sep = ";")
setwd("C:/Users/hecto/OneDrive/Escritorio/BNO/Connectivity_data")
library("igraph")
library("plyr")
archiuFly <- read.csv("v1.2_exported-traced-adjacencies-v1.2.csv",sep = ",",header = F,skip = 1)
# archiuFly[,1] <- as.numeric(as.factor(archiuFly[,1]))
# archiuFly[,2] <- as.numeric(as.factor(archiuFly[,2]))
# archiuFly[,3] <- as.numeric(as.factor(archiuFly[,3]))
# gFly <- graph_from_edgelist(as.matrix(archiuFly[,c(1,2)]), directed = TRUE)
#
# gFlyS <- simplify( gFly , remove.multiple = T, remove.loops = F, edge.attr.comb=c(weight="sum", type="ignore") )
#
# save(gFlyS, file="gFlyS.RData")
load("gFlyS.RData")
set.seed(2706)
er_Fly <- sample_gnm(n=length(unique(archiuFly[,1])), m=length(E(gFlyS))) #n= NUmero de nodes (unique(archiuFly[,1])) m=numero de links (length(E(gFlyS)))
#plot(er_Fly, vertex.size=6, vertex.label=NA, layout=layout_in_circle)
deg_erFly <- degree(er_Fly, mode="all")
deg.dist_erFlyF <- degree_distribution(er_Fly, cumulative=F, mode="all")
plot( x=0:max(deg_erFly), y=deg.dist_erFlyF, pch=19, cex=1.2, col="blue",
log='y',
xlab="Degree", ylab="Log Frequency")
deg.dist_erFlyT <- degree_distribution(er_Fly, cumulative=T, mode="all")
plot( x=0:max(deg_erFly), y=1-deg.dist_erFlyT, pch=19, cex=1.2, col="blue",
xlab="Degree", ylab="Cumulative Frequency")
#Hubs
hs_FlyOptic <- hub_score(er_Fly, weights=NA)$vector
hs_FlyOptic
#Authorities
as_FlyOptic <- authority_score(er_Fly, weights=NA)$vector
as_FlyOptic
# documentacio matriu https://www.wormatlas.org/neuronalwiring.html#NeuronalconnectivityII
# documentacio igraph https://kateto.net/netscix2016.html
archiu <- read.csv("NeuronConnect.csv",sep = ";")
unique(archiu$Type)
head(archiu[,1:2])
length(archiu[,1])
print(archiu[456,3])
ab <- nrow(archiu)
for (i in 1:ab) {
if(archiu[i,3]=="R" | archiu[i,3]=="Rp"){
archiu[i,] <- archiu[i, c(2,1,3,4)]
}
if(archiu[i,3]=="EJ"){
archiu <- rbind.fill(archiu,archiu[i,])
}
}
g <- graph_from_edgelist(as.matrix(archiu[,c(1,2)]), directed = TRUE)
E(g)$weight <- archiu$Nbr
E(g)$name <- archiu$Type
gs <- simplify( g , remove.multiple = T, remove.loops = F, edge.attr.comb=c(weight="sum", type="ignore") )
l <- layout_with_fr(gs)
plot(gs, rescale=F, layout=l*0.4)
ba_xarxa3 <-  sample_pa(n=283, power=1, m=11,  directed=T)
plot(ba_xarxa3, vertex.size=6, vertex.label=NA, layout=layout_in_circle)
deg_xarxa3 <- degree(ba_xarxa3, mode="all")
deg.dist_xarxaF3 <- degree_distribution(ba_xarxa3, cumulative=F, mode="all")
plot( x=0:max(deg_xarxa3), y=deg.dist_xarxaF3, pch=19, cex=1.2, col="blue",
log='y',
xlab="Degree", ylab="Log Frequency")
deg.dist_xarxaT3 <- degree_distribution(ba_xarxa3, cumulative=T, mode="all")
plot( x=0:max(deg_xarxa3), y=1-deg.dist_xarxaT3, pch=19, cex=1.2, col="blue",
xlab="Degree", ylab="Cumulative Frequency")
tirad_census_FlyOptic = barplot(ba_xarxa3(er_Fly), log="y")
tirad_census_FlyOptic
tirad_census_FlyOptic = barplot(ba_xarxa3(er_Fly), log="y")
tirad_census_FlyOptic
tirad_census_ba_xarxa3 = barplot(triad_census(ba_xarxa3), log="y")
tirad_census_ba_xarxa3
#Hubs
hs_ba_xarxa3 <- hub_score(ba_xarxa3, weights=NA)$vector
hs_ba_xarxa3
#Authorities
as_ba_xarxa3 <- authority_score(ba_xarxa3, weights=NA)$vector
as_ba_xarxa3
tirad_census_ba_fly = barplot(triad_census(ba_fly), log="y")
tirad_census_ba_fly
ba_fly <-  sample_pa(n=length(unique(archiuFly[,1])), power=1, m=11,  directed=T)
#plot(ba_fly, vertex.size=6, vertex.label=NA, layout=layout_in_circle)
deg_baFly <- degree(ba_fly, mode="all")
deg.dist_baFlyF <- degree_distribution(ba_fly, cumulative=F, mode="all")
plot( x=0:max(deg_baFly), y=deg.dist_baFlyF, pch=19, cex=1.2, col="blue",
log='y',
xlab="Degree", ylab="Log Frequency")
deg.dist_baFyT <- degree_distribution(ba_fly, cumulative=T, mode="all")
plot( x=0:max(deg_baFly), y=1-deg.dist_baFyT, pch=19, cex=1.2, col="blue",
xlab="Degree", ylab="Cumulative Frequency")
tirad_census_ba_fly = barplot(triad_census(ba_fly), log="y")
tirad_census_ba_fly
#Hubs
hs_ba_fly <- hub_score(ba_fly, weights=NA)$vector
hs_ba_fly
#Authorities
as_gFlyOpticS <- authority_score(ba_fly, weights=NA)$vector
as_gFlyOpticS
tirad_census_FlyOptic = barplot(triad_census(gFlyOpticS), log="y")
tirad_census_FlyOptic
#Degree distribution
plot(gFlyOpticS, vertex.size=6, vertex.label=NA, layout=layout_in_circle)
degFlyOptic <- degree(gFlyOpticS, mode="all")
deg.degFlyOF <- degree_distribution(gFlyOpticS, cumulative=F, mode="all")
plot( x=0:max(degFlyOptic), y=deg.degFlyOF, pch=19, cex=1.2, col="orange",
log='y',
xlab="Degree", ylab="Log Frequency")
deg.degFlyOT <- degree_distribution(gFlyOpticS, cumulative=T, mode="all")
plot( x=0:max(degFlyOptic), y=1-deg.degFlyOT, pch=19, cex=1.2, col="orange",
xlab="Degree", ylab="Cumulative Frequency")
archiuFlyOPtic <- read.table("FlyCircuit.csv",sep = ";",row.names=1,header=T)
gFlyOptic <- graph_from_adjacency_matrix(as.matrix(archiuFlyOPtic))
gFlyOpticS <- simplify(gFlyOptic , remove.multiple = T, remove.loops = F, edge.attr.comb=c(weight="sum", type="ignore") )
l <- layout_with_fr(gFlyOpticS)
plot(gFlyOpticS, rescale=F, layout=l*0.4)
#Degree distribution
plot(gFlyOpticS, vertex.size=6, vertex.label=NA, layout=layout_in_circle)
degFlyOptic <- degree(gFlyOpticS, mode="all")
deg.degFlyOF <- degree_distribution(gFlyOpticS, cumulative=F, mode="all")
plot( x=0:max(degFlyOptic), y=deg.degFlyOF, pch=19, cex=1.2, col="orange",
log='y',
xlab="Degree", ylab="Log Frequency")
deg.degFlyOT <- degree_distribution(gFlyOpticS, cumulative=T, mode="all")
plot( x=0:max(degFlyOptic), y=1-deg.degFlyOT, pch=19, cex=1.2, col="orange",
xlab="Degree", ylab="Cumulative Frequency")
tirad_sw_xarxa2 = barplot(triad_census(sw_xarxa2), log="y")
tirad_sw_xarxa2
sw_xarxa2 <- sample_smallworld(dim=1, size=283, nei=11, p=0.1)
plot(sw_xarxa2, vertex.size=6, vertex.label=NA, layout=layout_in_circle)
deg_xarxa2 <- degree(sw_xarxa2, mode="all")
deg.dist_xarxaF2 <- degree_distribution(sw_xarxa2, cumulative=F, mode="all")
plot( x=0:max(deg_xarxa2), y=deg.dist_xarxaF2, pch=19, cex=1.2, col="blue",
log='y',
xlab="Degree", ylab="Log Frequency")
deg.dist_xarxaT2 <- degree_distribution(sw_xarxa2, cumulative=T, mode="all")
plot( x=0:max(deg_xarxa2), y=1-deg.dist_xarxaT2, pch=19, cex=1.2, col="blue",
xlab="Degree", ylab="Cumulative Frequency")
tirad_sw_xarxa2 = barplot(triad_census(sw_xarxa2), log="y")
tirad_sw_xarxa2
#Hubs
hs_sw_xarxa2 <- hub_score(sw_xarxa2, weights=NA)$vector
hs_sw_xarxa2
#Authorities
as_sw_xarxa2 <- authority_score(sw_xarxa2, weights=NA)$vector
as_sw_xarxa2
set.seed(2706)
er_xarxa1 <- sample_gnm(n=283, m=3109)
plot(er_xarxa1, vertex.size=6, vertex.label=NA, layout=layout_in_circle)
deg_xarxa1 <- degree(er_xarxa1, mode="all")
deg.dist_xarxaF1 <- degree_distribution(er_xarxa1, cumulative=F, mode="all")
plot( x=0:max(deg_xarxa1), y=deg.dist_xarxaF1, pch=19, cex=1.2, col="blue",
log='y',
xlab="Degree", ylab="Log Frequency")
deg.dist_xarxaT1 <- degree_distribution(er_xarxa1, cumulative=T, mode="all")
plot( x=0:max(deg_xarxa1), y=1-deg.dist_xarxaT1, pch=19, cex=1.2, col="blue",
xlab="Degree", ylab="Cumulative Frequency")
tirad_er_xarxa1 = barplot(triad_census(er_xarxa1), log="y")
tirad_er_xarxa1
#Hubs
hs_er_xarxa1 <- hub_score(er_xarxa1, weights=NA)$vector
hs_er_xarxa1
#Authorities
as_er_xarxa1 <- authority_score(er_xarxa1, weights=NA)$vector
as_er_xarxa1
sessionInfo
sessionInfo()
