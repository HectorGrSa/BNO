library("igraph")
library("plyr")
archiu <- read.csv("NeuronConnect.csv",sep = ";")
setwd("C:/Users/hecto/OneDrive/Escritorio/BNO/Connectivity_data")
library("igraph")
library("plyr")
# documentacio matriu https://www.wormatlas.org/neuronalwiring.html#NeuronalconnectivityII
# documentacio igraph https://kateto.net/netscix2016.html
archiu <- read.csv("NeuronConnect.csv",sep = ";")
unique(archiu$Type)
ab <- nrow(archiu)
for (i in 1:ab) {
if(archiu[i,3]=="R" | archiu[i,3]=="Rp"){
archiu[i,] <- archiu[i, c(2,1,3,4)]
}
if(archiu[i,3]=="EJ"){
archiu <- rbind.fill(archiu,archiu[i,])
}
}
g <- graph_from_edgelist(as.matrix(archiu[,c(1,2)]), directed = FALSE)
E(g)$weight <- archiu$Nbr
E(g)$name <- archiu$Type
gs <- simplify( g , remove.multiple = T, remove.loops = F, edge.attr.comb=c(weight="sum", type="ignore") )
l <- layout_with_fr(gs)
plot(gs, rescale=F, layout=l*0.4)
l <- layout_with_fr(gs)
V(gs)$color <- colrs[V(gs)$media.type]
V(gs)$size <- V(gs)$audience.size*0.7
V(gs)$label.color <- "black"
V(gs)$label <- NA
E(gs)$width <- E(gs)$weight/6
E(gs)$arrow.size <- .2
E(gs)$width <- 1+E(gs)$weight/12
plot(gs,rescale=F,layout=l*0.8)
#Color nodes along the diameter:
diam <- get_diameter(gs, directed=T)
as.vector(diam)
vcol <- rep("gray40", vcount(gs))
vcol[diam] <- "gold"
ecol <- rep("gray80", ecount(gs))
ecol[E(gs, path=diam)] <- "orange"
plot(gs, rescale=F,vertex.color=vcol, edge.color=ecol, edge.arrow.mode=0)
#Degree distribution
plot(gs, vertex.size=6, vertex.label=NA, layout=layout_in_circle)
deg <- degree(gs, mode="all")
deg.distF <- degree_distribution(gs, cumulative=F, mode="all")
deg.distT <- degree_distribution(gs, cumulative=T, mode="all")
#Triad census
tirad_gs = triad_census(gs)
#Hubs
hs_gs <- hub_score(gs, weights=NA)$vector
#Authorities
as_gs <- authority_score(gs, weights=NA)$vector
#Small-Worldness ratio:
SM_Ratio_gs = transitivity(gs)/mean_distance(gs)
#modularity
library(leiden)
#comunitats
comunitats_gs <- cluster_louvain(gs)
communitySize_gs <- comunitats_gs
#cliques
cliques_gs <- cliques(gs)
celegans_data <- list()
celegans_data[["deg_distF_celegans"]] <- deg.distF
celegans_data[["deg_distT_celegans"]] <- deg.distT
celegans_data[["triad_census_celegans"]] <- tirad_gs
celegans_data[["hub_score_celegans"]] <- hs_gs
celegans_data[["modularity_celegans"]] <- modularity_gs
celegans_data[["authority_score_celegans"]] <- as_gs
celegans_data[["communitySize_celegans"]] <- communitySize_gs
celegans_data[["SW_ratio_celegans"]] <- SM_Ratio_gs
celegans_data[["cliques_celegans"]] <- cliques_gs
save(celegans_data, file="celegans_data.RData")
load("celegans_data.RData")
gsize(gs)
#Degree distribution
plot(gs, vertex.size=6, vertex.label=NA, layout=layout_in_circle)
deg <- degree(gs, mode="all")
deg.distF <- degree_distribution(gs, cumulative=F, mode="all")
deg.distT <- degree_distribution(gs, cumulative=T, mode="all")
#Triad census
tirad_gs = triad_census(gs)
#Hubs
hs_gs <- hub_score(gs, weights=NA)$vector
#Authorities
as_gs <- authority_score(gs, weights=NA)$vector
#Small-Worldness ratio:
SM_Ratio_gs = transitivity(gs)/mean_distance(gs)
#modularity
library(leiden)
adj_mtx_gs  <- igraph::as_adjacency_matrix(gs)
wtc_gs <- leiden(adj_mtx_gs)
modularity_gs <- modularity(gs, wtc_gs)
#comunitats
comunitats_gs <- cluster_louvain(gs)
communitySize_gs <- comunitats_gs
#cliques
cliques_gs <- cliques(gs)
#n nodes
nNodes_gs <- gsize(gs)
celegans_data <- list()
celegans_data[["deg_distF_celegans"]] <- deg.distF
celegans_data[["deg_distT_celegans"]] <- deg.distT
celegans_data[["triad_census_celegans"]] <- tirad_gs
celegans_data[["hub_score_celegans"]] <- hs_gs
celegans_data[["modularity_celegans"]] <- modularity_gs
celegans_data[["authority_score_celegans"]] <- as_gs
celegans_data[["communitySize_celegans"]] <- communitySize_gs
celegans_data[["SW_ratio_celegans"]] <- SM_Ratio_gs
celegans_data[["cliques_celegans"]] <- cliques_gs
celegans_data[["nNodes_celegans"]] <- nNodes_gs
save(celegans_data, file="celegans_data.RData")
load("celegans_data.RData")
View(celegans_data)
sw_xarxa2 <- sample_smallworld(dim=1, size=283, nei=11, p=0.1)
plot(sw_xarxa2, vertex.size=6, vertex.label=NA, layout=layout_in_circle)
deg_xarxa2 <- degree(sw_xarxa2, mode="all")
deg.dist_xarxaF2 <- degree_distribution(sw_xarxa2, cumulative=F, mode="all")
deg.dist_xarxaT2 <- degree_distribution(sw_xarxa2, cumulative=T, mode="all")
tirad_sw_xarxa2 = triad_census(sw_xarxa2)
#Hubs
hs_sw_xarxa2 <- hub_score(sw_xarxa2, weights=NA)$vector
#Authorities
as_sw_xarxa2 <- authority_score(sw_xarxa2, weights=NA)$vector
#Small-Worldness ratio:
SM_Ratio_sw_xarxa2 = transitivity(sw_xarxa2)/mean_distance(sw_xarxa2)
#modularity
library(leiden)
adj_mtx_sw_xarxa2  <- igraph::as_adjacency_matrix(sw_xarxa2)
wtc_sw_xarxa2 <- leiden(adj_mtx_sw_xarxa2)
modularity_sw_xarxa2 <- modularity(sw_xarxa2, wtc_sw_xarxa2)
#comunitats
comunitats_sw_xarxa2 <- cluster_louvain(sw_xarxa2)
communitySize_sw_xarxa2 <- comunitats_sw_xarxa2
#cliques
cliques_sw_xarxa2 <- cliques(sw_xarxa2)
#n nodes
nNodes_sw_xarxa2 <- gsize(sw_xarxa2)
celegansSW_data <- list()
celegansSW_data[["deg_distF_celegansSW"]] <- deg.dist_xarxaF2
celegansSW_data[["deg_distT_celegansSW"]] <- deg.dist_xarxaT2
celegansSW_data[["triad_census_celegansSW"]] <- tirad_sw_xarxa2
celegansSW_data[["hub_score_celegansSW"]] <- hs_sw_xarxa2
celegansSW_data[["modularity_celegansSW"]] <- modularity_sw_xarxa2
celegansSW_data[["authority_score_celegansSW"]] <- as_sw_xarxa2
celegansSW_data[["communitySize_celegansSW"]] <- communitySize_sw_xarxa2
celegansSW_data[["SW_ratio_celegansSW"]] <- SM_Ratio_sw_xarxa2
celegansSW_data[["cliques_celegansSW"]] <- cliques_sw_xarxa2
celegansSW_data[["nNodes_celegansSW"]] <- nNodes_sw_xarxa2
save(celegansSW_data, file="celegansSW_data.RData")
load("celegansSW_data.RData")
ba_xarxa3 <-  sample_pa(n=283, power=1, m=11,  directed=F)
deg_xarxa3 <- degree(ba_xarxa3, mode="all")
deg.dist_xarxaF3 <- degree_distribution(ba_xarxa3, cumulative=F, mode="all")
deg.dist_xarxaT3 <- degree_distribution(ba_xarxa3, cumulative=T, mode="all")
tirad_census_ba_xarxa3 = triad_census(ba_xarxa3)
#Hubs
hs_ba_xarxa3 <- hub_score(ba_xarxa3, weights=NA)$vector
#Authorities
as_ba_xarxa3 <- authority_score(ba_xarxa3, weights=NA)$vector
#Small-Worldness ratio:
SM_Ratio_ba_xarxa3 = transitivity(ba_xarxa3)/mean_distance(ba_xarxa3)
#modularity
library(leiden)
adj_mtx_ba_xarxa3  <- igraph::as_adjacency_matrix(ba_xarxa3)
wtc_ba_xarxa3 <- leiden(adj_mtx_ba_xarxa3)
modularity_ba_xarxa3 <- modularity(ba_xarxa3, wtc_ba_xarxa3)
#comunitats
comunitats_ba_xarxa3 <- cluster_louvain(ba_xarxa3)
communitySize_ba_xarxa3 <- comunitats_ba_xarxa3
#cliques
cliques_ba_xarxa3 <- cliques(ba_xarxa3)
#n nodes
nNodes_ba_xarxa3 <- gsize(ba_xarxa3)
celegansBA_data <- list()
celegansBA_data[["deg_distF_celegansBA"]] <- deg.dist_xarxaF3
celegansBA_data[["deg_distT_celegansBA"]] <- deg.dist_xarxaT3
celegansBA_data[["triad_census_celegansBA"]] <- tirad_census_ba_xarxa3
celegansBA_data[["hub_score_celegansBA"]] <- hs_ba_xarxa3
celegansBA_data[["modularity_celegansBA"]] <- modularity_ba_xarxa3
celegansBA_data[["authority_score_celegansBA"]] <- as_ba_xarxa3
celegansBA_data[["communitySize_celegansBA"]] <- communitySize_ba_xarxa3
celegansBA_data[["SW_ratio_celegansBA"]] <- SM_Ratio_ba_xarxa3
celegansBA_data[["cliques_celegansBA"]] <- cliques_ba_xarxa3
celegansBA_data[["nNodes_celegansBA"]] <- nNodes_ba_xarxa3
save(celegansBA_data, file="celegansBA_data.RData")
load("celegansBA_data.RData")
sw_xarxa2 <- sample_smallworld(dim=1, size=283, nei=11, p=0.1)
plot(sw_xarxa2, vertex.size=6, vertex.label=NA, layout=layout_in_circle)
deg_xarxa2 <- degree(sw_xarxa2, mode="all")
deg.dist_xarxaF2 <- degree_distribution(sw_xarxa2, cumulative=F, mode="all")
deg.dist_xarxaT2 <- degree_distribution(sw_xarxa2, cumulative=T, mode="all")
tirad_sw_xarxa2 = triad_census(sw_xarxa2)
#Hubs
hs_sw_xarxa2 <- hub_score(sw_xarxa2, weights=NA)$vector
#Authorities
as_sw_xarxa2 <- authority_score(sw_xarxa2, weights=NA)$vector
#Small-Worldness ratio:
SM_Ratio_sw_xarxa2 = transitivity(sw_xarxa2)/mean_distance(sw_xarxa2)
#modularity
library(leiden)
adj_mtx_sw_xarxa2  <- igraph::as_adjacency_matrix(sw_xarxa2)
wtc_sw_xarxa2 <- leiden(adj_mtx_sw_xarxa2)
modularity_sw_xarxa2 <- modularity(sw_xarxa2, wtc_sw_xarxa2)
#comunitats
comunitats_sw_xarxa2 <- cluster_louvain(sw_xarxa2)
communitySize_sw_xarxa2 <- comunitats_sw_xarxa2
#cliques
cliques_sw_xarxa2 <- cliques(sw_xarxa2)
#n nodes
nNodes_sw_xarxa2 <- gsize(sw_xarxa2)
celegansSW_data <- list()
celegansSW_data[["deg_distF_celegansSW"]] <- deg.dist_xarxaF2
celegansSW_data[["deg_distT_celegansSW"]] <- deg.dist_xarxaT2
celegansSW_data[["triad_census_celegansSW"]] <- tirad_sw_xarxa2
celegansSW_data[["hub_score_celegansSW"]] <- hs_sw_xarxa2
celegansSW_data[["modularity_celegansSW"]] <- modularity_sw_xarxa2
celegansSW_data[["authority_score_celegansSW"]] <- as_sw_xarxa2
celegansSW_data[["communitySize_celegansSW"]] <- communitySize_sw_xarxa2
celegansSW_data[["SW_ratio_celegansSW"]] <- SM_Ratio_sw_xarxa2
celegansSW_data[["cliques_celegansSW"]] <- cliques_sw_xarxa2
celegansSW_data[["nNodes_celegansSW"]] <- nNodes_sw_xarxa2
save(celegansSW_data, file="celegansSW_data.RData")
load("celegansSW_data.RData")
View(celegans_data)
View(celegansBA_data)
View(celegansSW_data)
